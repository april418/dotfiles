#!/bin/bash

# This code inspired by @koara-local.
# https://github.com/koara-local/dotfiles/edit/master/bin/get_os_info
#
# Thanks a lot!

detect_os_bit() {
  echo $(uname -m)
}

detect_os_destribution() {
  local pattern='[-_]release$\|[-_]version$'
  local destribution_types=(debian redhat arch)
  local destributions=(centos ubuntu fedora oracle turbolinux suse mandriva vine gentoo)
  local destribution_type=""
  local destribution=""

  for i in $(ls /etc | grep $pattern | sed -e "s/$pattern//g" | tr 'A-Z' 'a-z')
  do
    case "${destribution_types[@]}" in
      *"$i"*) destribution_type="$i" ;;
    esac
    case "${destributions[@]}" in
      *"$i"*) destribution="$i" ;;
    esac
  done

  destribution_type=${destribution_type:-'unknown'}
  destribution=${destribution:-'unknown'}

  echo "$destribution $destribution_type"
}

detect_os() {
  echo "$(detect_os_destribution) $(detect_os_bit)"
}

detect_os

